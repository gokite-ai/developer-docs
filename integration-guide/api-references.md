# API References

Complete API documentation for integrating with Kite's agentic payment infrastructure.

## ğŸ¯ Target Audiences & Authentication

**Kite does NOT store user credentials to manage users' financial resources.** All user authentication flows through trusted third-party OAuth providers.

| Audience | Purpose | Primary Authentication | Secondary Tools |
|----------|---------|----------------------|-----------------|
| **End-users** | Connect wallet/account, approve delegations | **ğŸ” Third-party OAuth** (Google, Coinbase, PayPal) | None - OAuth only |
| **Agent Builders** | Build AI agents that make payments autonomously | **ğŸ” OAuth for end-users** + Proof of Delegation | Developer API key for agent management |
| **Merchants/Payment Providers** | Integrate checkout and verify agent-initiated payments | **ğŸ” Proof of Delegation verification** | Developer API key for merchant operations |

### ğŸš¨ Key Security Principles
- **Kite never store user passwords or financial credentials**
- **Kite never hold user funds directly** 
- **All user authentication flows through trusted OAuth providers**
- **Financial operations require cryptographic proof of user consent**

## ğŸ” Authentication Layers

### 1. OAuth (Primary Authentication)
- **Users authenticate through third-party providers** (Google, Coinbase, PayPal)
- **Kite does not store user credentials** - we never handle user financial accounts
- **Used for delegation and user identification** - the core of our security model
- **Third-party compliance** - leverages existing AML/KYC from providers

### 2. Proof of Delegation (Runtime Authorization)
- **Generated by agents during payment sessions** with user consent
- **Verified by Kite and merchants** for secure transactions
- **Includes session guardrails, spending limits, and merchant details**
- **Cryptographically signed** and tamper-evident

### 3. Developer API Key (Secondary Tools)
- **Used for non-critical operations** like agent registration and merchant setup
- **Scoped by role and permissions** for administrative functions
- **Not used for financial operations** - OAuth and proofs handle those

## ğŸ“‹ API Documentation by Workflow

### [End-user OAuth API](api-end-user-oauth.md) - **Primary Integration**
**Core authentication and delegation management for end-users.**

**Key Features:**
- Third-party OAuth integration (Google, Coinbase, PayPal)
- Wallet connection and management
- Delegation approval workflows
- Account and session management

### [Agent Builders API](api-agent-builders.md) - **Secondary Integration**
**Build AI agents that can make payments autonomously using OAuth-based delegation.**

**Key Features:**
- User OAuth integration (primary)
- KitePass creation and management
- Proof of delegation generation
- Agent registration (API key for non-critical operations)

### [Merchants & Payment Providers API](api-merchants-payment-providers.md) - **Secondary Integration**
**Receive and verify agent-initiated payments using proof verification.**

**Key Features:**
- Proof of delegation verification (primary)
- Stablecoin transfer requests
- Payment confirmation and settlement
- Merchant operations (API key for administrative functions)

## ğŸ› ï¸ SDK & Sample Code

### Quick Start Examples

**Python SDK - OAuth First:**
```python
from kite_sdk import KiteClient

# Initialize client (OAuth is primary, API key is optional)
client = KiteClient()

# User authenticates via OAuth (Google, Coinbase, PayPal)
user_token = client.oauth.authenticate_user(
    provider="google",
    redirect_uri="https://your-app.com/callback"
)

# Create delegation session with OAuth user
session = client.sessions.create_with_oauth(
    user_token=user_token,
    agent_id="agent_456"
)

# Generate delegation proof (OAuth-based)
proof = session.generate_delegation_proof(
    merchant_id="merchant_789",
    amount="50.00",
    currency="USDC"
)
```

**Node.js SDK - OAuth First:**
```javascript
const { KiteClient } = require('@kite/sdk');

// Initialize client (OAuth is primary)
const client = new KiteClient();

// User authenticates via OAuth
const userToken = await client.oauth.authenticateUser({
  provider: 'coinbase',
  redirectUri: 'https://your-app.com/callback'
});

// Create delegation with OAuth user
const proof = await client.sessions.generateDelegationProof({
  userToken: userToken,
  merchantId: 'merchant_456',
  amount: '100.00',
  currency: 'USDC'
});
```

## ğŸ”’ Security & Compliance

### Key Security Principles
- **OAuth-First Authentication:** Users authenticate through trusted third parties (Google, Coinbase, PayPal)
- **No Credential Storage:** Kite never stores user credentials or financial account details
- **No Direct Fund Handling:** Kite facilitates but doesn't hold funds - we're not a financial institution
- **Third-Party Compliance:** Leverages existing AML/KYC from OAuth providers
- **Cryptographic Proofs:** All delegations are cryptographically signed and tamper-evident
- **Session Guardrails:** Enforceable spending limits and constraints

### Compliance Features
- **Third-Party AML/KYC:** Inherits compliance from OAuth providers
- **Audit Trails:** Complete transaction history with cryptographic proofs
- **Regulatory Reporting:** Built-in compliance reporting tools
- **GDPR Compliance:** Full data portability and deletion rights

## ğŸ“Š Workflow Diagrams

### Agent Payment Flow
```
User â†’ Agent â†’ Kite API â†’ Merchant â†’ Settlement
  â†“      â†“        â†“         â†“         â†“
OAuth â†’ Session â†’ Proof â†’ Verify â†’ Transfer
```

### Merchant Integration Flow
```
Agent â†’ Merchant â†’ Kite API â†’ Verification â†’ Settlement
  â†“        â†“         â†“           â†“            â†“
Proof â†’ Checkout â†’ Verify â†’ Transfer â†’ Confirm
```

## ğŸš€ Quick Reference

| Endpoint | Method | Primary Auth | Secondary Auth | Use Case |
|----------|--------|--------------|-----------------|----------|
| `/v1/oauth/authorize` | POST | **OAuth** | - | User authentication |
| `/v1/delegations` | POST | **OAuth** | API Key (optional) | Generate proof |
| `/v1/verifications` | POST | **Proof Verification** | API Key (optional) | Verify proof |
| `/v1/transfers` | POST | **Proof Verification** | API Key (optional) | Request payment |
| `/v1/agents` | POST | - | API Key | Create agent (admin) |